function rowsToQuestions(rows){
  const header = rows[0].map(h => h.trim());
  const idx = (name) => header.indexOf(name);

  const qi = {
    id: idx('id'),
    question: idx('question'),
    answer: idx('answer'),
    alt: idx('alt_answers'),
    img: idx('image_url'),
    enabled: idx('enabled')
  };

  const out = [];
  for (let r=1; r<rows.length; r++){
    const row = rows[r];
    if (!row[qi.id] || !row[qi.question]) continue;
    if (row[qi.enabled] && row[qi.enabled].toUpperCase() === "FALSE") continue;

    const accepts = [];
    if (row[qi.answer]) accepts.push(row[qi.answer].trim());
    if (row[qi.alt]) {
      accepts.push(...row[qi.alt].split('|').map(s => s.trim()));
    }

    out.push({
      id: row[qi.id].trim(),
      text: row[qi.question].trim(),
      image: row[qi.img] ? row[qi.img].trim() : '',
      type: 'typing',
      accept: accepts
    });
  }
  return out;
}
